import{_ as Q}from"./Button.B7dY0lcR.js";import{_ as Z,p,a9 as ee,h as V,q as te,v as ae,B as le,c as q,o as I,j as s,a0 as oe,t as i,N as ne,n as se,G as m,w as k,a as D,d as ue}from"./framework.Gi3K-aNU.js";import{w as ie}from"./tool.D1yyrI_Z.js";const re={class:"container"},ve={class:"content"},ce={class:"heatmap-wrapper"},fe={class:"canvas-container"},de={class:"coordinates",id:"coordinates"},pe={class:"controls"},me={class:"control-group"},he={class:"control-row"},_e={class:"control-item"},Me={class:"control-item"},xe={class:"control-group"},we={class:"data-info",id:"dataInfo"},ye={class:"btn-group"},w=612,y=831,ge=Object.assign({name:"JBHeatMap2D"},{__name:"HeatMap2D",setup(O){const g=p(null);let h=null;const r=p(36),d=p(36),X=p(80),v=p(Math.floor(w/r.value)),c=p(Math.floor(y/d.value)),Y=p(0),N=p(0),u=ee({visible:!1,x:0,y:0,col:0,row:0,value:0,rawX:0,rawY:0}),f=p([]),A=V(()=>{var e;let a=0;for(let t=0;t<c.value;t++)for(let l=0;l<v.value;l++)((e=f.value[t])==null?void 0:e[l])>0&&a++;return a}),U=V(()=>{var e;let a=0;for(let t=0;t<c.value;t++)for(let l=0;l<v.value;l++)((e=f.value[t])==null?void 0:e[l])>a&&(a=f.value[t][l]);return a}),$=V(()=>{var t;let a=0,e=0;for(let l=0;l<c.value;l++)for(let o=0;o<v.value;o++){const n=(t=f.value[l])==null?void 0:t[o];n>0&&(a+=n,e++)}return e>0?a/e:0});function E(a,e){const t=e>0?a/e:0;return t<.25?"rgb(43, 88, 118)":t<.5?"rgb(78, 67, 118)":t<.75?"rgb(178, 69, 146)":"rgb(241, 95, 121)"}function _(){if(h){h.clearRect(0,0,w,y);for(let a=0;a<c.value;a++)for(let e=0;e<v.value;e++){const t=f.value[a][e];if(t>0){const l=e*r.value,o=a*d.value;h.fillStyle=E(t,X.value),h.fillRect(l,o,r.value,d.value)}}}}function R(){f.value=Array(c.value).fill().map(()=>Array(v.value).fill(0))}function b(a,e,t,l){for(let o=0;o<c.value;o++)for(let n=0;n<v.value;n++){const H=n*r.value+r.value/2,B=o*d.value+d.value/2,C=Math.sqrt((H-a)**2+(B-e)**2);if(C<t){const j=l*(1-C/t);f.value[o][n]=Math.max(f.value[o][n],Math.floor(j))}}}function F(a,e,t,l){const o=Math.floor(a/r.value),n=Math.floor(e/d.value),H=Math.max(0,o-t),B=Math.min(v.value-1,o+t),C=Math.max(0,n-t),j=Math.min(c.value-1,n+t);for(let M=C;M<=j;M++)for(let x=H;x<=B;x++){const W=Math.sqrt((x-o)**2+(M-n)**2);if(W<t){const P=l*(1-W/t);f.value[M][x]=Math.min(100,Math.max(f.value[M][x],Math.floor(P)))}}_()}function G(){for(let a=0;a<c.value;a++)for(let e=0;e<v.value;e++)f.value[a][e]=Math.random()<.1?Math.floor(Math.random()*100):0;console.log("数据已生成",f.value),_()}function S(){z(),b(50,50,30,90),b(150,100,25,80),b(80,200,35,95),b(180,250,40,85),_()}function z(){for(let a=0;a<c.value;a++)for(let e=0;e<v.value;e++)f.value[a][e]=0;_()}function L(){var l;if(r.value<1||r.value>100||d.value<1||d.value>100){alert("请输入有效的热力块尺寸（1-100）");return}const a=JSON.parse(JSON.stringify(f.value)),e=v.value,t=c.value;v.value=Math.floor(w/r.value),c.value=Math.floor(y/d.value),R();for(let o=0;o<Math.min(c.value,t.value);o++)for(let n=0;n<Math.min(v.value,e);n++)f.value[o][n]=((l=a[o])==null?void 0:l[n])||0;_()}let J=!1;function T(a){const e=g.value.getBoundingClientRect(),t=a.clientX-e.left,l=a.clientY-e.top;Y.value=Math.floor(t),N.value=Math.floor(l);const o=Math.floor(t/r.value),n=Math.floor(l/d.value);o>=0&&o<v.value&&n>=0&&n<c.value?(u.visible=!0,u.col=o,u.row=n,u.value=f.value[n][o],u.rawX=t,u.rawY=l,u.x=a.clientX+15,u.y=a.clientY-30):u.visible=!1,J&&F(t,l,5,60)}function K(){J=!1,u.visible=!1}return te(X,()=>_()),ae(()=>{h=g.value.getContext("2d"),v.value=Math.floor(w/r.value),c.value=Math.floor(y/d.value),R(),S()}),(a,e)=>{const t=le("el-input"),l=Q;return I(),q("div",re,[s("div",ve,[s("div",ce,[s("div",fe,[s("canvas",{ref_key:"heatmapCanvas",ref:g,id:"heatmap-canvas",width:"612",height:"831",onMousemove:T,onMouseleave:K,onContextmenu:e[0]||(e[0]=oe(()=>{},["prevent"]))},null,544),s("div",de,"X: "+i(Y.value)+", Y: "+i(N.value),1),s("div",{class:se(["tooltip",{show:u.visible}]),style:ne({left:u.x+"px",top:u.y+"px"})},[e[3]||(e[3]=s("h3",null,"热力块信息",-1)),s("p",null,"位置: ("+i(u.col)+", "+i(u.row)+")",1),s("p",null,"值: "+i(u.value),1),s("p",null,"坐标: ("+i(Math.floor(u.rawX))+", "+i(Math.floor(u.rawY))+")",1)],6)])])]),s("div",pe,[s("div",me,[s("div",he,[s("div",_e,[e[4]||(e[4]=s("label",{for:"blockWidth"},"热力块宽度 (px)",-1)),m(t,{type:"number",id:"blockWidth",min:"1",max:"100",modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=o=>r.value=o),modelModifiers:{number:!0}},null,8,["modelValue"])]),s("div",Me,[e[5]||(e[5]=s("label",{for:"blockHeight"},"热力块高度 (px)",-1)),m(t,{type:"number",id:"blockHeight",min:"1",max:"100",modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=o=>d.value=o),modelModifiers:{number:!0}},null,8,["modelValue"])])]),m(l,{type:"primary",onClick:L},{default:k(()=>[...e[6]||(e[6]=[D("应用热力块尺寸",-1)])]),_:1})]),s("div",xe,[s("div",we," 热力图尺寸: "+i(w)+"px × "+i(y)+"px、 热力块数量: "+i(v.value.value)+" × "+i(c.value.value)+" (共"+i(v.value.value*c.value.value)+"个)、 每个热力块尺寸: "+i(r.value)+"px × "+i(d.value)+"px、 活跃热力块: "+i(A.value)+"、 最大值: "+i(U.value)+"、 平均值: "+i($.value.toFixed(2)),1)]),s("div",ye,[m(l,{type:"primary",onClick:G},{default:k(()=>[...e[7]||(e[7]=[D("随机生成数据",-1)])]),_:1}),m(l,{type:"primary",onClick:S},{default:k(()=>[...e[8]||(e[8]=[D("重置数据",-1)])]),_:1}),m(l,{type:"primary",onClick:z},{default:k(()=>[...e[9]||(e[9]=[D("清除数据",-1)])]),_:1})])])])}}}),be=Z(ge,[["__scopeId","data-v-117697df"]]),Ce=ue({name:"JBHeatMap2D",__name:"BasicsHeatMap",setup(O){return(g,h)=>{const r=be;return I(),q("div",null,[m(r)])}}}),Be=ie(Ce);export{Be as JBHeatMap2D};
