const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunks/OrbitControls.DeqrMTPs.js","assets/chunks/three.module.Bqa0_Ymz.js"])))=>i.map(i=>d[i]);
import{d as O,p as v,v as te,a0 as ne,x as oe,c as V,o as A,j as R,e as se,k as C,N as ae,_ as re,G as ie}from"./framework.BS0Gy2Cs.js";import{S as ce,e as y,P as le,W as ue,f as de,D as pe,G as me,g as fe,h as he,R as we,i as _e,j as Y,c as ve,k as ye,M as ge}from"./three.module.Bqa0_Ymz.js";import{w as xe}from"./tool.D1yyrI_Z.js";const be={id:"heatmap-box"},Me=["innerHTML"],r=50,g=.1,Ce=O({name:"JB-HeatMap",__name:"HeatMap",setup(P){const j=v(!1);let c,w,p,D,m,B,b,f=[],H=null;te(async()=>{const{OrbitControls:t}=await ne(async()=>{const{OrbitControls:e}=await import("./OrbitControls.DeqrMTPs.js");return{OrbitControls:e}},__vite__mapDeps([0,1]));K(),D=new t(w,p.domElement),D.enableDamping=!0,D.dampingFactor=.05});const T=v(900),X=v("0"),$=v("0");v("悬停在方块上查看详细信息");const _=v({show:!1,x:0,y:0,content:""}),J=t=>{const e=[];for(let h=0;h<t;h++){const i=[];for(let l=0;l<t;l++)h===10&&l===10?i.push(150):i.push(0);e.push(i)}return e},W=(t,e,n,o,s)=>{const a=(n-o)/(s-o),i=.1+Math.pow(a,.7)*3,l=new Y(g,i,g),M=l.attributes.position,k=new y(10170623),x=new y(65535),E=new y(16776960),Q=new y(16711680),S=[];for(let L=0;L<M.count;L++){const u=(M.getY(L)+i/2)/i;let d=new y;a<.3?d.lerpColors(k,x,u):a<.6?u<.5?d.lerpColors(k,x,u*2):d.lerpColors(x,E,(u-.5)*2):u<1/3?d.lerpColors(k,x,u*3):u<2/3?d.lerpColors(x,E,(u-1/3)*3):d.lerpColors(E,Q,(u-2/3)*3),S.push(d.r,d.g,d.b)}const Z=new Float32Array(S);l.setAttribute("color",new ve(Z,3));const ee=new ye({vertexColors:!0}),I=new ge(l,ee);return I.userData={value:n,x:t,z:e},I.position.set((t-r/2)*g,i/2,(e-r/2)*g),I},z=()=>{let t=1/0,e=-1/0,n=0;for(let o=0;o<r;o++)for(let s=0;s<r;s++){const a=f[o][s];a>.1&&(n++,a<t&&(t=a),a>e&&(e=a))}n===0&&(t=0,e=0),T.value=n,$.value=t.toFixed(2),X.value=e.toFixed(2)},q=()=>{for(;m.children.length>0;)m.remove(m.children[0]);f=J(r),z();let t=1/0,e=-1/0;for(let n=0;n<r;n++)for(let o=0;o<r;o++){const s=f[n][o];s<t&&(t=s),s>e&&(e=s)}for(let n=0;n<r;n++)for(let o=0;o<r;o++){const s=f[n][o],a=W(n,o,s,t,e);m.add(a)}},U=()=>{for(let t=0;t<r;t++)for(let e=0;e<r;e++)f[t][e]+=(Math.random()-.5)*.2,f[t][e]=Math.min(15,Math.max(0,f[t][e]));m.children.forEach(t=>{const e=t,n=e.userData.x,o=e.userData.z,s=f[n][o],a=.1+s/15*3;e.geometry.dispose(),e.geometry=new Y(g,a,g),e.position.y=a/2,e.userData.value=s}),z()},G=t=>{const e=document.getElementById("three-container");if(!e)return;const n=e.getBoundingClientRect(),o=(t.clientX-n.left)/n.width,s=(t.clientY-n.top)/n.height;b.x=o*2-1,b.y=-(s*2-1),B.setFromCamera(b,w);const a=B.intersectObjects(m.children);if(a.length>0){const h=a[0].object,i=h.userData.value,l=h.userData.x,M=h.userData.z;_.value={show:!0,x:t.clientX-n.left+10,y:t.clientY-n.top-30,content:`数值: ${i.toFixed(2)}<br>位置: (${l}, ${M})`}}else _.value={..._.value,show:!1}},F=()=>{H=requestAnimationFrame(F),j.value&&U(),p.render(c,w)},N=()=>{},K=()=>{c=new ce,c.background=new y(858922),w=new le(75,600/500,.1,1e3),w.position.set(5,5,5),p=new ue({antialias:!0}),p.setSize(600,500),p.shadowMap.enabled=!0;const t=document.getElementById("three-container");if(t)t.appendChild(p.domElement);else{console.error("无法找到ID为'three-container'的元素");return}const e=new de(16777215,.5);c.add(e);const n=new pe(16777215,.8);n.position.set(10,20,5),n.castShadow=!0,c.add(n),m=new me,c.add(m);const o=new fe(r,r,4473924,2236962);o.position.y=-.05,c.add(o);const s=new he(5);c.add(s),q(),B=new we,b=new _e,window.addEventListener("mousemove",G,!1),window.addEventListener("resize",N),F()};return oe(()=>{H&&cancelAnimationFrame(H),window.removeEventListener("mousemove",G),window.removeEventListener("resize",N),p&&p.dispose()}),(t,e)=>(A(),V("div",null,[R("div",be,[C(_).show?(A(),V("div",{key:0,class:"tooltip",style:ae({left:C(_).x+"px",top:C(_).y+"px"}),innerHTML:C(_).content},null,12,Me)):se("",!0),e[0]||(e[0]=R("div",{id:"three-container"},null,-1))])]))}}),De=re(Ce,[["__scopeId","data-v-63c26c4f"]]),Be=O({name:"JBHeatMap",__name:"BasicsHeatMap",setup(P){return(j,c)=>{const w=De;return A(),V("div",null,[ie(w)])}}}),Le=xe(Be);export{Le as JBHeatMap};
