import{_ as Q}from"./Button.B7dY0lcR.js";import{_ as Z,p,a9 as ee,h as V,q as te,v as oe,B as ae,c as W,o as q,j as s,a0 as le,t as i,N as ne,n as se,G as m,w as k,a as D,d as ue}from"./framework.Gi3K-aNU.js";import{w as ie}from"./tool.D1yyrI_Z.js";const re={class:"container"},ve={class:"content"},ce={class:"heatmap-wrapper"},fe={class:"canvas-container"},de={class:"coordinates",id:"coordinates"},pe={class:"controls"},me={class:"control-group"},he={class:"control-row"},Me={class:"control-item"},_e={class:"control-item"},we={class:"control-group"},xe={class:"data-info",id:"dataInfo"},ye={class:"btn-group"},x=612,y=831,be=Object.assign({name:"JBHeatMap2D"},{__name:"HeatMap2D",setup(I){const b=p(null);let h=null;const r=p(36),d=p(36),X=p(80),v=p(Math.floor(x/r.value)),c=p(Math.floor(y/d.value)),Y=p(0),N=p(0),u=ee({visible:!1,x:0,y:0,col:0,row:0,value:0,rawX:0,rawY:0}),f=p([]),O=V(()=>{var e;let t=0;for(let o=0;o<c.value;o++)for(let l=0;l<v.value;l++)((e=f.value[o])==null?void 0:e[l])>0&&t++;return t}),A=V(()=>{var e;let t=0;for(let o=0;o<c.value;o++)for(let l=0;l<v.value;l++)((e=f.value[o])==null?void 0:e[l])>t&&(t=f.value[o][l]);return t}),$=V(()=>{var o;let t=0,e=0;for(let l=0;l<c.value;l++)for(let a=0;a<v.value;a++){const n=(o=f.value[l])==null?void 0:o[a];n>0&&(t+=n,e++)}return e>0?t/e:0});function E(t,e){const o=e>0?t/e:0;return o<.25?"rgb(43, 88, 118)":o<.5?"rgb(78, 67, 118)":o<.75?"rgb(178, 69, 146)":"rgb(241, 95, 121)"}function M(){if(h){h.clearRect(0,0,x,y);for(let t=0;t<c.value;t++)for(let e=0;e<v.value;e++){const o=f.value[t][e];if(o>0){const l=e*r.value,a=t*d.value;h.fillStyle=E(o,X.value),h.fillRect(l,a,r.value,d.value)}}}}function R(){f.value=Array(c.value).fill().map(()=>Array(v.value).fill(0))}function g(t,e,o,l){for(let a=0;a<c.value;a++)for(let n=0;n<v.value;n++){const H=n*r.value+r.value/2,B=a*d.value+d.value/2,C=Math.sqrt((H-t)**2+(B-e)**2);if(C<o){const j=l*(1-C/o);f.value[a][n]=Math.max(f.value[a][n],Math.floor(j))}}}function F(t,e,o,l){const a=Math.floor(t/r.value),n=Math.floor(e/d.value),H=Math.max(0,a-o),B=Math.min(v.value-1,a+o),C=Math.max(0,n-o),j=Math.min(c.value-1,n+o);for(let _=C;_<=j;_++)for(let w=H;w<=B;w++){const U=Math.sqrt((w-a)**2+(_-n)**2);if(U<o){const P=l*(1-U/o);f.value[_][w]=Math.min(100,Math.max(f.value[_][w],Math.floor(P)))}}M()}function G(){for(let t=0;t<c.value;t++)for(let e=0;e<v.value;e++)f.value[t][e]=Math.random()<.1?Math.floor(Math.random()*100):0;console.log("数据已生成",f.value),M()}function S(){z(),g(50,50,30,90),g(150,100,25,80),g(80,200,35,95),g(180,250,40,85),M()}function z(){for(let t=0;t<c.value;t++)for(let e=0;e<v.value;e++)f.value[t][e]=0;M()}function L(){var l;if(r.value<1||r.value>100||d.value<1||d.value>100){alert("请输入有效的热力块尺寸（1-100）");return}const t=JSON.parse(JSON.stringify(f.value)),e=v.value,o=c.value;v.value=Math.floor(x/r.value),c.value=Math.floor(y/d.value),R();for(let a=0;a<Math.min(c.value,o.value);a++)for(let n=0;n<Math.min(v.value,e);n++)f.value[a][n]=((l=t[a])==null?void 0:l[n])||0;M()}let J=!1;function T(t){const e=b.value.getBoundingClientRect(),o=t.clientX-e.left,l=t.clientY-e.top;Y.value=Math.floor(o),N.value=Math.floor(l);const a=Math.floor(o/r.value),n=Math.floor(l/d.value);a>=0&&a<v.value&&n>=0&&n<c.value?(u.visible=!0,u.col=a,u.row=n,u.value=f.value[n][a],u.rawX=o,u.rawY=l,u.x=t.clientX+15,u.y=t.clientY-30):u.visible=!1,J&&F(o,l,5,60)}function K(){J=!1,u.visible=!1}return te(X,()=>M()),oe(()=>{h=b.value.getContext("2d"),v.value=Math.floor(x/r.value),c.value=Math.floor(y/d.value),R(),S()}),(t,e)=>{const o=ae("el-input"),l=Q;return q(),W("div",re,[s("div",ve,[s("div",ce,[s("div",fe,[s("canvas",{ref_key:"heatmapCanvas",ref:b,id:"heatmapCanvas",width:"612",height:"831",onMousedown:e[0]||(e[0]=(...a)=>t.handleMouseDown&&t.handleMouseDown(...a)),onMousemove:T,onMouseup:e[1]||(e[1]=(...a)=>t.handleMouseUp&&t.handleMouseUp(...a)),onMouseleave:K,onContextmenu:e[2]||(e[2]=le(()=>{},["prevent"]))},null,544),s("div",de,"X: "+i(Y.value)+", Y: "+i(N.value),1),s("div",{class:se(["tooltip",{show:u.visible}]),style:ne({left:u.x+"px",top:u.y+"px"})},[e[5]||(e[5]=s("h3",null,"热力块信息",-1)),s("p",null,"位置: ("+i(u.col)+", "+i(u.row)+")",1),s("p",null,"值: "+i(u.value),1),s("p",null,"坐标: ("+i(Math.floor(u.rawX))+", "+i(Math.floor(u.rawY))+")",1)],6)])])]),s("div",pe,[s("div",me,[s("div",he,[s("div",Me,[e[6]||(e[6]=s("label",{for:"blockWidth"},"热力块宽度 (px)",-1)),m(o,{type:"number",id:"blockWidth",min:"1",max:"100",modelValue:r.value,"onUpdate:modelValue":e[3]||(e[3]=a=>r.value=a),modelModifiers:{number:!0}},null,8,["modelValue"])]),s("div",_e,[e[7]||(e[7]=s("label",{for:"blockHeight"},"热力块高度 (px)",-1)),m(o,{type:"number",id:"blockHeight",min:"1",max:"100",modelValue:d.value,"onUpdate:modelValue":e[4]||(e[4]=a=>d.value=a),modelModifiers:{number:!0}},null,8,["modelValue"])])]),m(l,{type:"primary",onClick:L},{default:k(()=>[...e[8]||(e[8]=[D("应用热力块尺寸",-1)])]),_:1})]),s("div",we,[s("div",xe," 热力图尺寸: "+i(x)+"px × "+i(y)+"px、 热力块数量: "+i(v.value.value)+" × "+i(c.value.value)+" (共"+i(v.value.value*c.value.value)+"个)、 每个热力块尺寸: "+i(r.value)+"px × "+i(d.value)+"px、 活跃热力块: "+i(O.value)+"、 最大值: "+i(A.value)+"、 平均值: "+i($.value.toFixed(2)),1)]),s("div",ye,[m(l,{type:"primary",onClick:G},{default:k(()=>[...e[9]||(e[9]=[D("随机生成数据",-1)])]),_:1}),m(l,{type:"primary",onClick:S},{default:k(()=>[...e[10]||(e[10]=[D("重置数据",-1)])]),_:1}),m(l,{type:"primary",onClick:z},{default:k(()=>[...e[11]||(e[11]=[D("清除数据",-1)])]),_:1})])])])}}}),ge=Z(be,[["__scopeId","data-v-0f35bc22"]]),Ce=ue({name:"JBHeatMap2D",__name:"BasicsHeatMap",setup(I){return(b,h)=>{const r=ge;return q(),W("div",null,[m(r)])}}}),Be=ie(Ce);export{Be as JBHeatMap2D};
