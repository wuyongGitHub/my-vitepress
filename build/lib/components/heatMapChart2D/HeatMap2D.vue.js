"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const J=require("../button/Button.vue.js"),e=require("vue");;/* empty css                */const A=require("../../_virtual/_plugin-vue_export-helper.js"),I={class:"container"},F={class:"content"},L={class:"heatmap-wrapper"},P={class:"canvas-container"},G={class:"coordinates",id:"coordinates"},K={class:"controls"},Q={class:"control-group"},Z={class:"control-row"},$={class:"control-item"},ee={class:"control-item"},te={class:"control-group"},le={class:"data-info",id:"dataInfo"},oe={class:"btn-group"},M=612,y=831,ae=Object.assign({name:"JBHeatMap2D"},{__name:"HeatMap2D",setup(re){const N=e.ref(null);let p=null;const c=e.ref(36),d=e.ref(36),b=e.ref(80),s=e.ref(Math.floor(M/c.value)),u=e.ref(Math.floor(y/d.value)),S=e.ref(0),_=e.ref(0),i=e.reactive({visible:!1,x:0,y:0,col:0,row:0,value:0,rawX:0,rawY:0}),v=e.ref([]),B=e.computed(()=>{var t;let l=0;for(let o=0;o<u.value;o++)for(let n=0;n<s.value;n++)((t=v.value[o])==null?void 0:t[n])>0&&l++;return l}),X=e.computed(()=>{var t;let l=0;for(let o=0;o<u.value;o++)for(let n=0;n<s.value;n++)((t=v.value[o])==null?void 0:t[n])>l&&(l=v.value[o][n]);return l}),Y=e.computed(()=>{var o;let l=0,t=0;for(let n=0;n<u.value;n++)for(let a=0;a<s.value;a++){const r=(o=v.value[n])==null?void 0:o[a];r>0&&(l+=r,t++)}return t>0?l/t:0});function q(l,t){const o=t>0?l/t:0;return o<.25?"rgb(43, 88, 118)":o<.5?"rgb(78, 67, 118)":o<.75?"rgb(178, 69, 146)":"rgb(241, 95, 121)"}function f(){if(p){p.clearRect(0,0,M,y);for(let l=0;l<u.value;l++)for(let t=0;t<s.value;t++){const o=v.value[l][t];if(o>0){const n=t*c.value,a=l*d.value;p.fillStyle=q(o,b.value),p.fillRect(n,a,c.value,d.value)}}}}function E(){v.value=Array(u.value).fill().map(()=>Array(s.value).fill(0))}function g(l,t,o,n){for(let a=0;a<u.value;a++)for(let r=0;r<s.value;r++){const x=r*c.value+c.value/2,w=a*d.value+d.value/2,V=Math.sqrt((x-l)**2+(w-t)**2);if(V<o){const D=n*(1-V/o);v.value[a][r]=Math.max(v.value[a][r],Math.floor(D))}}}function R(l,t,o,n){const a=Math.floor(l/c.value),r=Math.floor(t/d.value),x=Math.max(0,a-o),w=Math.min(s.value-1,a+o),V=Math.max(0,r-o),D=Math.min(u.value-1,r+o);for(let m=V;m<=D;m++)for(let h=x;h<=w;h++){const H=Math.sqrt((h-a)**2+(m-r)**2);if(H<o){const W=n*(1-H/o);v.value[m][h]=Math.min(100,Math.max(v.value[m][h],Math.floor(W)))}}f()}function z(){for(let l=0;l<u.value;l++)for(let t=0;t<s.value;t++)v.value[l][t]=Math.random()<.1?Math.floor(Math.random()*100):0;console.log("数据已生成",v.value),f()}function C(){k(),g(50,50,30,90),g(150,100,25,80),g(80,200,35,95),g(180,250,40,85),f()}function k(){for(let l=0;l<u.value;l++)for(let t=0;t<s.value;t++)v.value[l][t]=0;f()}function T(){var n;if(c.value<1||c.value>100||d.value<1||d.value>100){alert("请输入有效的热力块尺寸（1-100）");return}const l=JSON.parse(JSON.stringify(v.value)),t=s.value,o=u.value;s.value=Math.floor(M/c.value),u.value=Math.floor(y/d.value),E();for(let a=0;a<Math.min(u.value,o.value);a++)for(let r=0;r<Math.min(s.value,t);r++)v.value[a][r]=((n=l[a])==null?void 0:n[r])||0;f()}let j=!1;function O(l){const t=N.value.getBoundingClientRect(),o=l.clientX-t.left,n=l.clientY-t.top;S.value=Math.floor(o),_.value=Math.floor(n);const a=Math.floor(o/c.value),r=Math.floor(n/d.value);a>=0&&a<s.value&&r>=0&&r<u.value?(i.visible=!0,i.col=a,i.row=r,i.value=v.value[r][a],i.rawX=o,i.rawY=n,i.x=l.clientX+15,i.y=l.clientY-30):i.visible=!1,j&&R(o,n,5,60)}function U(){j=!1,i.visible=!1}return e.watch(b,()=>f()),e.onMounted(()=>{p=N.value.getContext("2d"),s.value=Math.floor(M/c.value),u.value=Math.floor(y/d.value),E(),C()}),(l,t)=>{const o=e.resolveComponent("el-input"),n=J.default;return e.openBlock(),e.createElementBlock("div",I,[e.createElementVNode("div",F,[e.createElementVNode("div",L,[e.createElementVNode("div",P,[e.createElementVNode("canvas",{ref_key:"heatmapCanvas",ref:N,id:"heatmapCanvas",width:"612",height:"831",onMousedown:t[0]||(t[0]=(...a)=>l.handleMouseDown&&l.handleMouseDown(...a)),onMousemove:O,onMouseup:t[1]||(t[1]=(...a)=>l.handleMouseUp&&l.handleMouseUp(...a)),onMouseleave:U,onContextmenu:t[2]||(t[2]=e.withModifiers(()=>{},["prevent"]))},null,544),e.createElementVNode("div",G,"X: "+e.toDisplayString(S.value)+", Y: "+e.toDisplayString(_.value),1),e.createElementVNode("div",{class:e.normalizeClass(["tooltip",{show:i.visible}]),style:e.normalizeStyle({left:i.x+"px",top:i.y+"px"})},[t[5]||(t[5]=e.createElementVNode("h3",null,"热力块信息",-1)),e.createElementVNode("p",null,"位置: ("+e.toDisplayString(i.col)+", "+e.toDisplayString(i.row)+")",1),e.createElementVNode("p",null,"值: "+e.toDisplayString(i.value),1),e.createElementVNode("p",null,"坐标: ("+e.toDisplayString(Math.floor(i.rawX))+", "+e.toDisplayString(Math.floor(i.rawY))+")",1)],6)])])]),e.createElementVNode("div",K,[e.createElementVNode("div",Q,[e.createElementVNode("div",Z,[e.createElementVNode("div",$,[t[6]||(t[6]=e.createElementVNode("label",{for:"blockWidth"},"热力块宽度 (px)",-1)),e.createVNode(o,{type:"number",id:"blockWidth",min:"1",max:"100",modelValue:c.value,"onUpdate:modelValue":t[3]||(t[3]=a=>c.value=a),modelModifiers:{number:!0}},null,8,["modelValue"])]),e.createElementVNode("div",ee,[t[7]||(t[7]=e.createElementVNode("label",{for:"blockHeight"},"热力块高度 (px)",-1)),e.createVNode(o,{type:"number",id:"blockHeight",min:"1",max:"100",modelValue:d.value,"onUpdate:modelValue":t[4]||(t[4]=a=>d.value=a),modelModifiers:{number:!0}},null,8,["modelValue"])])]),e.createVNode(n,{type:"primary",onClick:T},{default:e.withCtx(()=>[...t[8]||(t[8]=[e.createTextVNode("应用热力块尺寸",-1)])]),_:1})]),e.createElementVNode("div",te,[e.createElementVNode("div",le," 热力图尺寸: "+e.toDisplayString(M)+"px × "+e.toDisplayString(y)+"px、 热力块数量: "+e.toDisplayString(s.value.value)+" × "+e.toDisplayString(u.value.value)+" (共"+e.toDisplayString(s.value.value*u.value.value)+"个)、 每个热力块尺寸: "+e.toDisplayString(c.value)+"px × "+e.toDisplayString(d.value)+"px、 活跃热力块: "+e.toDisplayString(B.value)+"、 最大值: "+e.toDisplayString(X.value)+"、 平均值: "+e.toDisplayString(Y.value.toFixed(2)),1)]),e.createElementVNode("div",oe,[e.createVNode(n,{type:"primary",onClick:z},{default:e.withCtx(()=>[...t[9]||(t[9]=[e.createTextVNode("随机生成数据",-1)])]),_:1}),e.createVNode(n,{type:"primary",onClick:C},{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("重置数据",-1)])]),_:1}),e.createVNode(n,{type:"primary",onClick:k},{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("清除数据",-1)])]),_:1})])])])}}}),ne=A.default(ae,[["__scopeId","data-v-481b569c"]]);exports.default=ne;
